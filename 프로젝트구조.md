# Modular Layered Architecture + Gateway

μ΄ μ €μ¥μ†λ” **λ„λ©”μΈ λ‹¨μ„ NestJS λ¨λ“**μ„ λ…λ¦½μ μΌλ΅ μ‹¤ν–‰ν•  μ μκ³ , λ™μ‹μ— **Gateway**λ¥Ό ν†µν•΄ λ‹¨μΌ API μ„λ²„λ΅ λ¬¶μ„ μ μλ” κµ¬μ΅°λ¥Ό μ κ³µν•©λ‹λ‹¤.

---

## π“¦ ν”„λ΅μ νΈ κ°μ”

```
.
β”β”€β”€ auth/                # μΈμ¦ λ¨λ“ (λ…λ¦½ μ‹¤ν–‰ κ°€λ¥)
β”β”€β”€ user/                # μ‚¬μ©μ λ¨λ“
β”β”€β”€ schedule/            # μΌμ • λ¨λ“
β”β”€β”€ notification/        # μ•λ¦Ό λ¨λ“
β”β”€β”€ label/               # λΌλ²¨ λ¨λ“
β”β”€β”€ admin/               # μ–΄λ“λ―Ό λ¨λ“
β”β”€β”€ gateway/             # ν†µν•© API κ²μ΄νΈμ›¨μ΄
β”β”€β”€ package.json         # μ›ν¬μ¤νμ΄μ¤ μ •μ + κ³µμ© μ¤ν¬λ¦½νΈ
β”β”€β”€ tsconfig.base.json   # TypeScript κ³µν†µ μ„¤μ •
β””β”€β”€ setup.js             # μƒ λ¨λ“/λ μ΄μ–΄ μ¤μΊν΄λ”© μ¤ν¬λ¦½νΈ
```

κ° λ¨λ“μ€ λ™μΌν• λ μ΄μ–΄ κµ¬μ΅°λ¥Ό λ”°λ¦…λ‹λ‹¤.

```
module/
β”β”€β”€ app/             # NestJS μ§„μ…μ (main.ts) λ° Module μ„ μ–Έ
β”β”€β”€ interface/       # Controller, νμ΄μ§€ λ“± μ…μ¶λ ¥ κ³„μΈµ
β”β”€β”€ application/     # μ μ¤μΌ€μ΄μ¤/μ„λΉ„μ¤ λ΅μ§
β”β”€β”€ domain/          # μμ μ—”ν‹°ν‹°/μΈν„°νμ΄μ¤
β”β”€β”€ infrastructure/  # DB, μ™Έλ¶€ μ„λΉ„μ¤ μ—°λ™ μ–΄λ‘ν„°
β””β”€β”€ shared/          # DTO, constants, κ³µν†µ μ ν‹Έ
```

---

## π§± λ μ΄μ–΄ μ±…μ„

| λ μ΄μ–΄            | μ±…μ„                                                             |
| ----------------- | ---------------------------------------------------------------- |
| `app/`            | Nest λ¶€νΈμ¤νΈλ©(Main)κ³Ό Module κµ¬μ„±                             |
| `interface/`      | Controller, Presenter, View λ“± μ‚¬μ©μ/ν΄λΌμ΄μ–ΈνΈμ™€μ κ²½κ³„       |
| `application/`    | μ μ¤μΌ€μ΄μ¤ λ΅μ§, μ„λΉ„μ¤, μ»¤λ§¨λ“ ν•Έλ“¤λ¬                          |
| `domain/`         | μ—”ν‹°ν‹°, κ°’ κ°μ²΄, λ¦¬ν¬μ§€ν† λ¦¬ μΈν„°νμ΄μ¤ λ“± λΉ„μ¦λ‹μ¤ κ·μΉ™         |
| `infrastructure/` | Prisma, BullMQ, μ™Έλ¶€ API, λ©”μΌλ¬ λ“± Infra μ—°λ™                  |
| `shared/`         | DTO, μƒμ, κ³µν†µ μ ν‹Έλ¦¬ν‹°                                        |

μμ΅΄ λ°©ν–¥μ€ **app β†’ interface β†’ application β†’ domain β†’ infrastructure** ν• λ°©ν–¥λ§ ν—μ©ν•μ—¬ μ μ§€λ³΄μμ„±μ„ ν™•λ³΄ν•©λ‹λ‹¤.

---

## π€ μ‹¤ν–‰ λ°©λ²•

### 1) λ¨λ“ κ°λ³„ μ‹¤ν–‰ (κ°λ°/λ””λ²„κΉ…)

```bash
npm install
npm run dev:auth
npm run dev:user
# ...ν•„μ”ν• λ¨λ“λ§ κ³¨λΌ μ‹¤ν–‰
```

κ° λ¨λ“ λ””λ ‰ν„°λ¦¬μ—μ„λ„ `npm run start:dev`λ΅ μ§μ ‘ μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤. λΉ λ¥΄κ² νΉμ • λ„λ©”μΈλ§ κ°λ°/ν…μ¤νΈν•  λ• μ μ©ν•©λ‹λ‹¤.

### 2) Gateway ν†µν•© μ‹¤ν–‰ (μ΄μ/λ°°ν¬)

```bash
npm run dev:gateway
```

`gateway/app/main.ts`κ°€ λ¶€νΈμ¤νΈλ©λλ©°, `GatewayModule`μ—μ„ λ¨λ“  λ¨λ“μ„ importν•μ—¬ λ‹¨μΌ API μ„λ²„λ¥Ό κµ¬μ„±ν•©λ‹λ‹¤. μ΄μ ν™κ²½μ—μ„λ” μ΄ λ°©μ‹μΌλ΅ ν•λ‚μ ν¬νΈμ—μ„ κ΄€λ¦¬ν•©λ‹λ‹¤.

---

## β™οΈ μ΄κΈ° μ…‹μ—…

```bash
npm install
node setup.js   # μƒ λ¨λ“/λ μ΄μ–΄ κ³¨κ²© μλ™ μƒμ„±
```

`setup.js`λ” `auth`, `user`, `schedule`, `notification`, `label`, `admin`, `gateway`μ— ν•„μ”ν• μ„λΈν΄λ”λ¥Ό μƒμ„±ν•©λ‹λ‹¤. μ‹ κ· λ¨λ“μ„ μ¶”κ°€ν•  λ• λ™μΌν• ν¨ν„΄μΌλ΅ μ†μ‰½κ² ν™•μ¥ν•  μ μμµλ‹λ‹¤.

---

## π§© κ°λ° ν

- λ…λ¦½ λ¨λ“ κµ¬μ΅° λ•λ¶„μ— **λ‹¨μ„ ν…μ¤νΈ**μ™€ **κΈ°λ¥ ν™•μ¥**μ΄ λ¨λ“ λ‹¨μ„λ΅ κΉ”λ”ν•κ² μ§„ν–‰λ©λ‹λ‹¤.
- ν†µν•© ν…μ¤νΈ, E2E ν…μ¤νΈλ” Gatewayλ¥Ό κΈ°μ¤€μΌλ΅ μν–‰ν•λ” κ²ƒμ„ κ¶μ¥ν•©λ‹λ‹¤.
- ν™κ²½λ³€μ(`AUTH_PORT`, `USER_PORT`, ... , `GATEWAY_PORT`)λ¥Ό μ‚¬μ©ν•΄ λ¨λ“λ³„ ν¬νΈλ¥Ό μμ λ΅­κ² κµ¬μ„±ν•  μ μμµλ‹λ‹¤.
- `infrastructure/`λ” μ‹¤μ  μ™Έλ¶€ μμ΅΄μ„±κ³Ό λ§λ‚λ” κµ¬κ°„μ΄λ―€λ΅, Repository/Provider λ“±μ„ λ…ν™•ν λ¶„λ¦¬ν•΄μ„ λ„λ©”μΈ κ³„μΈµμ„ λ³΄νΈν•©λ‹λ‹¤.

μ΄ κµ¬μ΅°λ¥Ό κΈ°λ°μΌλ΅ κ° λ¨λ“μ— μ‹¤μ  λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό μΈν”„λΌ μ—°κ²°μ„ μ±„μ› λ„£μΌλ©΄, λ…λ¦½μ„±κ³Ό ν†µν•©μ„±μ„ λ¨λ‘ λ§μ΅±ν•λ” ν’€μ¤νƒ μ•„ν‚¤ν…μ²λ¥Ό κµ¬μ¶•ν•  μ μμµλ‹λ‹¤.
