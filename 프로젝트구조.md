# Base Module Driven Monorepo

ì´ ì €ì¥ì†ŒëŠ” **BaseModule**ì„ ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë“  NestJS ëª¨ë“ˆì— ë™ì¼í•œ íŒ¨í„´ì„ ê°•ì œí•©ë‹ˆë‹¤. ê° ë„ë©”ì¸ ëª¨ë“ˆì€ Base ë ˆì´ì–´ë¥¼ ìƒì†í•´ ê³µí†µ ê¸°ëŠ¥(ì‘ë‹µ í¬ë§·, CRUD, ì €ì¥ì†Œ ê³„ì•½ ë“±)ì„ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš©í•˜ë©´ì„œ ë„ë©”ì¸ ê³ ìœ  ë¡œì§ë§Œ êµ¬í˜„í•©ë‹ˆë‹¤.

---

## ğŸ“¦ í”„ë¡œì íŠ¸ ì „ì²´ êµ¬ì¡°

```
.
â”œâ”€â”€ base/                # ê³µí†µ BaseModule + Controller/Service/Repository
â”œâ”€â”€ base/presentation/   # í”„ë ˆì  í…Œì´ì…˜ ê³µìš© ëª¨ë“ˆ(bootstrap + UI ì»´í¬ë„ŒíŠ¸)
â”œâ”€â”€ auth/                # ì¸ì¦ ë„ë©”ì¸ ëª¨ë“ˆ (presentation í¬í•¨)
â”œâ”€â”€ user/                # ì‚¬ìš©ì ë„ë©”ì¸ ëª¨ë“ˆ
â”œâ”€â”€ schedule/            # ì¼ì • ë„ë©”ì¸ ëª¨ë“ˆ
â”œâ”€â”€ notification/        # ì•Œë¦¼ ë„ë©”ì¸ ëª¨ë“ˆ
â”œâ”€â”€ label/               # ë¼ë²¨ ë„ë©”ì¸ ëª¨ë“ˆ
â”œâ”€â”€ admin/               # ì–´ë“œë¯¼ ë„ë©”ì¸ ëª¨ë“ˆ
â”œâ”€â”€ package.json         # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì •ì˜ + dev ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ tsconfig.base.json   # TypeScript ê³µí†µ(base alias í¬í•¨)
â””â”€â”€ setup.js             # ëª¨ë“ˆ/ë ˆì´ì–´ ìë™ ìŠ¤ìºí´ë”©
```

### base/ & base/presentationì´ ì œê³µí•˜ëŠ” ê²ƒ

| íŒŒì¼/í´ë˜ìŠ¤                                    | ì„¤ëª… |
| ---------------------------------------------- | ---- |
| `BaseModule` (`base/app/base.module.ts`)       | ëª¨ë“  ëª¨ë“ˆì´ ìƒì†. ëª¨ë“ˆ ì´ˆê¸°í™”/ë¡œê¹… ë“± ê³µí†µ ì²˜ë¦¬ |
| `BaseController` (`base/interface/...`)        | `success()/failure()` ì‘ë‹µ ê·œê²© ì œê³µ |
| `BaseService`, `BaseRepository`                | CRUD/ì¡°íšŒ ê¸°ë³¸ ë©”ì„œë“œ ì œê³µ |
| `BaseInMemoryRepository`                       | ì´ˆê¸° ê°œë°œìš© ë©”ëª¨ë¦¬ ì €ì¥ì†Œ |
| `BaseUseCase`, `BaseEntity`, `BaseResponse`    | ìœ ìŠ¤ì¼€ì´ìŠ¤/ì—”í‹°í‹°/DTO ê¸°ë³¸ í˜•íƒœ ì •ì˜ |
| `BaseCard`, `PageLayout`, `FormField`, `PrimaryButton` | ê³µìš© React UI ì»´í¬ë„ŒíŠ¸ (`base/presentation/src/components`) |
| `bootstrap(Page)`                              | ëª¨ë“  í”„ëŸ°íŠ¸ì—”ë“œ ì§„ì…ì ì„ í†µì¼í•˜ëŠ” helper (`base/presentation/src/main.tsx`) |
| `useForm`, `createAuthClient`                  | ì…ë ¥ ìƒíƒœ ê´€ë¦¬ + Auth API í˜¸ì¶œ í—¬í¼ |
| `AuthLoginPage`, `AuthRegisterPage`, `AuthApprovalPage`, `AuthPortalPage` | Base Presentationì´ ì œê³µí•˜ëŠ” ê³ ìˆ˜ì¤€ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ |

### ê° ë„ë©”ì¸ ëª¨ë“ˆ êµ¬ì¡°

```
module/
â”œâ”€â”€ app/                # BaseModule í™•ì¥, main.ts ë¶€íŠ¸ìŠ¤íŠ¸ë©
â”œâ”€â”€ interface/          # BaseController ìƒì† ì»¨íŠ¸ë¡¤ëŸ¬
â”œâ”€â”€ application/        # BaseService ìƒì† ì„œë¹„ìŠ¤/ìœ ìŠ¤ì¼€ì´ìŠ¤
â”œâ”€â”€ domain/             # BaseEntity í™•ì¥ ëª¨ë¸
â”œâ”€â”€ infrastructure/     # BaseRepository êµ¬í˜„ì²´ (in-memory â†’ DB êµì²´ ê°€ëŠ¥)
â”œâ”€â”€ shared/             # DTO/ìƒìˆ˜/ìœ í‹¸
â””â”€â”€ presentation/       # Base Presentationì„ ìƒì†í•œ React/Vite ì•±
    â””â”€â”€ src/pages/*.tsx # ì˜ˆ: LoginPage.tsx, RegisterPage.tsx, ApprovalPage.tsx (thin wrappers)
```

ì˜ì¡´ ë°©í–¥ì€ **base â†’ app â†’ interface â†’ application â†’ domain â†’ infrastructure** ë§Œ í—ˆìš©í•˜ì—¬ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•©ë‹ˆë‹¤.

---

## ğŸš€ ì‹¤í–‰ & ê°œë°œ ì›Œí¬í”Œë¡œìš°

### 1. ì„¤ì¹˜

```bash
npm install            # ëª¨ë“  ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì˜ì¡´ì„± ì„¤ì¹˜
```

React í´ë¼ì´ì–¸íŠ¸ê¹Œì§€ í•¨ê»˜ ê°œë°œí•˜ë ¤ë©´ ê° ëª¨ë“ˆì˜ `presentation` ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì˜ì¡´ì„±ê¹Œì§€ í•œ ë²ˆì— ì„¤ì¹˜ë©ë‹ˆë‹¤.

### 2. ëª¨ë“ˆ ê°œë³„ ì‹¤í–‰

```bash
npm run dev:auth       # AUTH_PORT (ê¸°ë³¸ 3010)ì—ì„œ ì„œë²„ ì‹œì‘
npm run dev:user       # USER_PORT (ê¸°ë³¸ 3020)
# í•„ìš” ëª¨ë“ˆë§Œ ì„ íƒí•´ì„œ ì‹¤í–‰
```

ê° ëª¨ë“ˆ í´ë”ì—ì„œë„ `npm run start:dev`ë¡œ ë‹¨ë… ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ê³µí†µ `success()` ì‘ë‹µ í¬ë§·ì„ ì‚¬ìš©í•˜ë©°, ì„œë¹„ìŠ¤ëŠ” BaseService ë•ë¶„ì— CRUD ë©”ì„œë“œë¥¼ ë°”ë¡œ í™œìš©í•©ë‹ˆë‹¤.  
í”„ëŸ°íŠ¸ì—”ë“œ ë ˆì´ì–´ëŠ” `base/presentation`ì˜ `bootstrap()`ì„ ì‚¬ìš©í•´ ëª¨ë‘ ë™ì¼í•œ ì§„ì… íŒ¨í„´ì„ ê°–ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Auth ëª¨ë“ˆì€ ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
npm run dev:auth       # ë°±ì—”ë“œ
npm run dev:auth-presentation   # React í”„ë¡ íŠ¸(ê¸°ë³¸ 4173)
```

### 3. í†µí•© ì‹¤í–‰ ì˜ˆì‹œ

Gateway ì—†ì´ë„ í•˜ë‚˜ì˜ Nest ì•±ì—ì„œ ì—¬ëŸ¬ ëª¨ë“ˆì„ ë¬¶ê³  ì‹¶ë‹¤ë©´, ì˜ˆë¥¼ ë“¤ì–´ `apps/api`ë¥¼ ì¶”ê°€í•´ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•©ë‹ˆë‹¤.

```ts
// apps/api/app/api.module.ts
@Module({
  imports: [AuthModule, UserModule, ScheduleModule, ...],
})
export class ApiModule extends BaseModule {
  protected moduleName = 'ApiModule';
}
```

```ts
// apps/api/app/main.ts
async function bootstrap() {
  const app = await NestFactory.create(ApiModule);
  await app.listen(process.env.API_PORT ?? 4000);
}
```

ì´ì²˜ëŸ¼ BaseModuleì„ ìƒì†í•˜ëŠ” ë‹¨ì¼ ì§„ì…ì ì„ ì›í•˜ëŠ” ê³³ì—ì„œ ë§Œë“¤ë©´, ë³„ë„ gateway íŒ¨í‚¤ì§€ ì—†ì´ë„ í†µí•© ì‹¤í–‰ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ§ª ì˜ˆì‹œ ê°œë°œ í”Œë¡œìš° (Auth ëª¨ë“ˆ)

1. **ë„ë©”ì¸ ì •ì˜**  
   - `auth/domain/models/auth-user.entity.ts`ì—ì„œ ê°€ì…ì/ìŠ¹ì¸ ìƒíƒœ ëª¨ë¸ ì •ì˜.
2. **ì €ì¥ì†Œ êµ¬í˜„**  
   - `auth/infrastructure/auth.repository.ts`ì—ì„œ `BaseInMemoryRepository` ìƒì† í›„ `findByUsername`, `findByEmail` ë“± í¸ì˜ ë©”ì„œë“œ ì¶”ê°€.
3. **ì„œë¹„ìŠ¤ ì‘ì„±**  
   - `auth/application/services/auth.service.ts`ì—ì„œ íšŒì›ê°€ì…/ë¡œê·¸ì¸/ìŠ¹ì¸/ëŒ€ê¸° ì¡°íšŒ ë¡œì§ì„ êµ¬í˜„.
4. **ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ì„±**  
   - `auth/interface/http/auth.controller.ts`ì—ì„œ JSON ê¸°ë°˜ ê°€ì…/ë¡œê·¸ì¸/ìŠ¹ì¸/ëŒ€ê¸° APIë¥¼ ë…¸ì¶œ.
5. **í”„ë ˆì  í…Œì´ì…˜ ì‘ì„±**  
   - `auth/presentation/src/pages/LoginPage.tsx`, `RegisterPage.tsx`, `ApprovalPage.tsx`ì²˜ëŸ¼ **thin wrapper** í˜ì´ì§€ë¥¼ ë§Œë“¤ê³  `@workwork/base-presentation`ì˜ `AuthLoginPage`, `AuthRegisterPage`, `AuthApprovalPage` ë“±ì„ ìƒì†í•´ API ê²½ë¡œë§Œ ì£¼ì…í•©ë‹ˆë‹¤.
6. **ëª¨ë“ˆ ì„ ì–¸ & ë¶€íŠ¸ìŠ¤íŠ¸ë©**  
   - `auth/app/auth.module.ts`ì—ì„œ BaseModule ìƒì†, `auth/app/main.ts`ì—ì„œ NestFactory ì‹¤í–‰.
7. **ì‹¤í–‰ í™•ì¸**  
   - `npm run dev:auth` í›„ REST í´ë¼ì´ì–¸íŠ¸ë¡œ `POST /auth/register`, `POST /auth/login`, `POST /auth/approve`(body: `{ username, token }`), `GET /auth/pending?token=...` ë¥¼ í˜¸ì¶œí•˜ê±°ë‚˜, `npm run dev:auth-presentation`ë¡œ React í”„ëŸ°íŠ¸ë¥¼ ë„ì›Œ ë™ì¼í•œ APIë¥¼ ì†Œë¹„í•´ íë¦„ì„ ê²€ì¦í•©ë‹ˆë‹¤.

ë‹¤ë¥¸ ëª¨ë“ˆë„ ë™ì¼í•œ íë¦„ìœ¼ë¡œ ê°œë°œí•˜ë©°, Base ê³„ì¸µ ë•ë¶„ì— CRUD/ì‘ë‹µ/ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´ì´ ìë™ìœ¼ë¡œ í†µì¼ë©ë‹ˆë‹¤.

---

## âœ… ìš´ì˜ íŒ

- Base í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•˜ë©´ ëª¨ë“  ëª¨ë“ˆì— ì¦‰ì‹œ ë°˜ì˜ë˜ë¯€ë¡œ, ë¡œê¹…/ì—ëŸ¬ ì²˜ë¦¬/ì‘ë‹µ í¬ë§·ì„ í•œ ê³³ì—ì„œ í†µì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `infrastructure/`ë¥¼ InMemoryì—ì„œ Prisma ë“± ì‹¤ì œ DB ì–´ëŒ‘í„°ë¡œ êµì²´í•´ë„, `BaseRepository` ê³„ì•½ë§Œ ì§€í‚¤ë©´ application/domain ì½”ë“œë¥¼ ë°”ê¾¸ì§€ ì•Šê³  í™•ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.
- í†µí•© í…ŒìŠ¤íŠ¸ë‚˜ E2E í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ë•ŒëŠ”, BaseModuleì„ í™•ì¥í•œ í†µí•© `ApiModule`(ë˜ëŠ” í•„ìš” ì‹œ ë³„ë„ gateway)ì„ ê¸°ì¤€ìœ¼ë¡œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

ì´ êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë„ë©”ì¸ ëª¨ë“ˆì„ ê³„ì† ì¶”ê°€í•˜ê±°ë‚˜ í™•ì¥í•˜ë©´, **ê³µí†µ ë¡œì§ ê°•ì œ + ê°œë°œ ìƒì‚°ì„± + ì½”ë“œ ì¼ê´€ì„±**ì„ ë™ì‹œì— ë§Œì¡±í•˜ëŠ” ì•„í‚¤í…ì²˜ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
